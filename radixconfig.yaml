apiVersion: radix.equinor.com/v1
kind: RadixApplication
metadata:
  name: radix-sub-pipeline-example
spec:
  build:
    variables:
      VAR1: value1     #it must be set, as it is expected by the pipeline
      VAR2: value2     #it can be set, if it does not exist - the pipeline will set default value
      VAR100: value100 #it is not used in the pipeline and its tasks
  environments:
    - name: dev
      build:
        from: pipeline-example-with-env-vars-for-envs
        variables:
          VAR1: "val1-for-dev"  #overrides common env-var VAR1 in the "dev" external pipeline
          CONNECTION_STRING: "Provider=MySQLProv;Data Source=devDb;" #overrides common env-var CONNECTION_STRING in the "dev" custom sub-pipeline
    - name: prod
      build:
        from: release
        variables:
          PROD_USER: "prod-user" #it exists only in prod environment
          CONNECTION_STRING: "Provider=MySQLProv;Data Source=prodDb;" #overrides common env-var CONNECTION_STRING in the "prod" custom sub-pipeline
  components:
    - name: frontend
      src: frontend
      ports:
        - name: http
          port: 8001
      publicPort: http
  dnsAppAlias:
    environment: dev
    component: frontend